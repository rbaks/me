<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><title>Deploy your Next.js website to Github Pages â€“ Andrianina Rabakoson</title><meta name="robots" content="follow, index"/><meta content="Setup your Next.js website to deploy on Github pages with Github Actions" name="description"/><meta property="og:url" content="https://andr.is-a.dev/me/blog/deploy-your-next-js-website-to-github-pages"/><link rel="canonical" href="https://andr.is-a.dev/me/blog/deploy-your-next-js-website-to-github-pages"/><meta property="og:type" content="website"/><meta property="og:site_name" content="Andrianina Rabakoson"/><meta property="og:description" content="Setup your Next.js website to deploy on Github pages with Github Actions"/><meta property="og:title" content="Deploy your Next.js website to Github Pages â€“ Andrianina Rabakoson"/><meta property="og:image" content="https://andr.is-a.dev/me/static/images/banner2.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@leeerob"/><meta name="twitter:title" content="Deploy your Next.js website to Github Pages â€“ Andrianina Rabakoson"/><meta name="twitter:description" content="Setup your Next.js website to deploy on Github pages with Github Actions"/><meta name="twitter:image" content="https://andr.is-a.dev/me/static/images/banner2.png"/><meta property="article:published_time" content="2022-03-15T00:00:00.000Z"/><meta name="next-head-count" content="19"/><link rel="preload" href="/me/fonts/ibm-plex-sans-var.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link href="/me/static/favicons/favicon.ico" rel="shortcut icon"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><meta content="#ffffff" name="theme-color"/><meta content="#ffffff" name="msapplication-TileColor"/><link rel="preload" href="/me/_next/static/css/8b19dd6c711f502f.css" as="style"/><link rel="stylesheet" href="/me/_next/static/css/8b19dd6c711f502f.css" data-n-g=""/><link rel="preload" href="/me/_next/static/css/e1ef029dc084cc1d.css" as="style"/><link rel="stylesheet" href="/me/_next/static/css/e1ef029dc084cc1d.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/me/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/me/_next/static/chunks/webpack-423ec9ae7ecbd965.js" defer=""></script><script src="/me/_next/static/chunks/main-0a86936fa7ece8b3.js" defer=""></script><script src="/me/_next/static/chunks/pages/_app-ce08eec0ff0a1d1e.js" defer=""></script><script src="/me/_next/static/chunks/930-d694c4c53b827b32.js" defer=""></script><script src="/me/_next/static/chunks/771-dc6be7b5b2668256.js" defer=""></script><script src="/me/_next/static/chunks/383-cab2d69d88013e08.js" defer=""></script><script src="/me/_next/static/chunks/380-c6ac6cd68120b730.js" defer=""></script><script src="/me/_next/static/chunks/pages/blog/%5Bslug%5D-a0eaebcff46452b0.js" defer=""></script><script src="/me/_next/static/qUJK-3Xpp2cRBJdT5XkrN/_buildManifest.js" defer=""></script><script src="/me/_next/static/qUJK-3Xpp2cRBJdT5XkrN/_ssgManifest.js" defer=""></script><script src="/me/_next/static/qUJK-3Xpp2cRBJdT5XkrN/_middlewareManifest.js" defer=""></script></head><body class="bg-white dark:bg-black text-white dark:text-black"><div id="__next" data-reactroot=""><div class="bg-gray-50 dark:bg-gray-900"><div class="flex flex-col justify-center px-8"><nav class="flex items-center justify-between w-full relative max-w-2xl border-gray-200 dark:border-gray-700 mx-auto pt-8 pb-8 sm:pb-16 text-gray-900 bg-gray-50 dark:bg-gray-900 bg-opacity-60 dark:text-gray-100"><a href="#skip" class="skip-nav">Skip to content</a><div class="ml-[-0.60rem]"><button class="mobile-menu_burger__wvd0z visible md:hidden" aria-label="Toggle menu" type="button"><svg class="h-5 w-5 absolute text-gray-900 dark:text-gray-100" width="20" height="20" viewBox="0 0 20 20" fill="none" data-hide="false"><path d="M2.5 7.5H17.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.5 12.5H17.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg><svg class="h-5 w-5 absolute text-gray-900 dark:text-gray-100" viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none" shape-rendering="geometricPrecision" data-hide="true"><path d="M18 6L6 18"></path><path d="M6 6l12 12"></path></svg></button><a class="font-normal text-gray-600 dark:text-gray-400 hidden md:inline-block p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-800 transition-all" href="/me"><span class="capsize">Home</span></a><a class="font-normal text-gray-600 dark:text-gray-400 hidden md:inline-block p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-800 transition-all" href="/me/blog"><span class="capsize">Blog</span></a><a class="font-normal text-gray-600 dark:text-gray-400 hidden md:inline-block p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-800 transition-all" href="/me/projects"><span class="capsize">Projects</span></a><a class="font-normal text-gray-600 dark:text-gray-400 hidden md:inline-block p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-800 transition-all" href="/me/about"><span class="capsize">About</span></a></div><button aria-label="Toggle Dark Mode" type="button" class="w-9 h-9 bg-gray-200 rounded-lg dark:bg-gray-600 flex items-center justify-center hover:ring-2 ring-gray-300 transition-all"></button></nav></div><main id="skip" class="flex flex-col justify-center px-8 bg-gray-50 dark:bg-gray-900"><article class="flex flex-col items-start justify-center w-full max-w-2xl mx-auto mb-16"><h1 class="mb-4 text-3xl font-bold tracking-tight text-black md:text-5xl dark:text-white">Deploy your Next.js website to Github Pages</h1><div class="flex flex-col items-start justify-between w-full mt-2 md:flex-row md:items-center"><div class="flex items-center"><div data-rmiz-wrap="visible"><img src="/me/avatar.jpg" alt="Andrianina Rabakoson" width="24" height="24" class="rounded-full"/><button aria-label="Zoom image" data-rmiz-btn-open="true"></button></div><p class="ml-2 text-sm text-gray-700 dark:text-gray-300">Andrianina Rabakoson<!-- --> /<!-- --> <!-- -->March 15, 2022</p></div><p class="mt-2 text-sm text-gray-600 dark:text-gray-400 min-w-32 md:mt-0">9 min read</p></div><div class="w-full mt-4 prose dark:prose-dark max-w-none"><p>The <a target="_blank" rel="noopener noreferrer" href="https://insights.stackoverflow.com/survey/2021#most-popular-technologies-webframe-prof">2021 Stackoverflow developer survey</a> revealed the massive adoption of Meta&#x27;s <a target="_blank" rel="noopener noreferrer" href="https://reactjs.org/">React.js</a> open source library within the frontend industry.</p>
<div data-rmiz-wrap="visible"><img src="/me/static/images/Nextjs/React-developer-survey.png" alt="Stackoverflow developer survey" width="730" class="rounded-lg"/><button aria-label="Zoom image" data-rmiz-btn-open="true"></button></div>
<p>In the meantime, developers started gathering maximum best practices on core <a target="_blank" rel="noopener noreferrer" href="https://web.dev/vitals/">web vitals</a> to boost the performance of their websites and get better <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Search_engine_optimization">search engine optimization</a>.</p>
<p>However, this is a lot of code to maintain that you are tempted to create a superset of React.js yourself to continue implementing those best practices across all of your websites.</p>
<p>Thankfully, some group of engineers from <a target="_blank" rel="noopener noreferrer" href="https://vercel.com/">Vercel</a> made and maintains all of this for us. Meet <strong><a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/">Next.js</a></strong>, <strong>the React Framework for production</strong>.
Next.js is a static site generator that seats on top of React.js and offers performance out of the box. It has features such as :</p>
<ul>
<li><a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/routing/introduction">File-system routing</a> as opposed to the React router</li>
<li><a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/basic-features/image-optimization">Image Optimization</a> out of the box</li>
<li><a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/basic-features/data-fetching/get-static-props">Static-site generation</a> and <a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/basic-features/data-fetching/get-server-side-props">server-side rendering</a></li>
<li><a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs">Code splitting and Bundling</a></li>
<li><a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/api-routes/introduction">API Routes</a></li>
</ul>
<p>And much more with <a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/getting-started">Zero configuration</a>. Next.js was then the way to go for people who cares a lot about performance.</p>
<p>Currently, the Vercel platform offers the simplest method of deploying your Next.js app to the internet, but it is not without its shortcomings.</p>
<div class="border border-green-200 dark:border-green-900 bg-green-50 dark:bg-green-900 rounded-xl p-6 my-4 w-full"><span>Pros of Vercel deployment</span><div class="mt-4"><div class="flex font-medium items-baseline mb-2"><div class="h-4 w-4 mr-2"><svg class="h-4 w-4 text-green-500" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"></path><path d="M22 4L12 14.01l-3-3"></path></g></svg></div><span>Designed for Nextjs and all of its features</span></div><div class="flex font-medium items-baseline mb-2"><div class="h-4 w-4 mr-2"><svg class="h-4 w-4 text-green-500" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"></path><path d="M22 4L12 14.01l-3-3"></path></g></svg></div><span>Deploy in seconds</span></div><div class="flex font-medium items-baseline mb-2"><div class="h-4 w-4 mr-2"><svg class="h-4 w-4 text-green-500" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"></path><path d="M22 4L12 14.01l-3-3"></path></g></svg></div><span>Serve your content at the edge</span></div><div class="flex font-medium items-baseline mb-2"><div class="h-4 w-4 mr-2"><svg class="h-4 w-4 text-green-500" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"></path><path d="M22 4L12 14.01l-3-3"></path></g></svg></div><span>Serverless functions</span></div></div></div>
<div class="border border-red-200 dark:border-red-900 bg-red-50 dark:bg-red-900 rounded-xl p-6 my-6 w-full"><span>Cons of Vercel deployment</span><div class="mt-4"><div class="flex font-medium items-baseline mb-2"><div class="h-4 w-4 mr-2"><svg class="h-4 w-4 text-red-500" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"></path><path d="M22 4L12 14.01l-3-3"></path></g></svg></div><span>Vendor lock-in (Flexibility issues)</span></div><div class="flex font-medium items-baseline mb-2"><div class="h-4 w-4 mr-2"><svg class="h-4 w-4 text-red-500" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"></path><path d="M22 4L12 14.01l-3-3"></path></g></svg></div><span>SSL certificate problems with some domain names</span></div><div class="flex font-medium items-baseline mb-2"><div class="h-4 w-4 mr-2"><svg class="h-4 w-4 text-red-500" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"></path><path d="M22 4L12 14.01l-3-3"></path></g></svg></div><span>Might not be free forever</span></div></div></div>
<p>Thanks to the Vercel team, they thought about us and added the <a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/advanced-features/static-html-export"><code>export</code></a> feature to the Next.js Framework.</p>
<blockquote>
<p>next export allows you to export your Next.js application to static HTML, which can be run standalone without the need of a Node.js server.</p>
</blockquote>
<p>In other words, it allows us to deploy our Next.js website to <a target="_blank" rel="noopener noreferrer" href="https://pages.github.com/">Github pages</a> that has no certificate problems, is always free, is fully flexible, has no data owned by third parties and is developer friendly. Thank you Vercel ðŸ¥³ðŸ¥³ðŸ¥³.</p>
<p>Nevertheless, there is no such thing as perfection. It is recommended to only use next export if you don&#x27;t need any of the <a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/advanced-features/static-html-export#unsupported-features">unsupported features</a> requiring a server. That is the purpose of this article where we will go through all the steps of configuring your Next.js website to mimic the normal Vercel deployment on GitHub Pages, which reflects how I made this entire portfolio website.</p>
<h2 id="table-of-contents"><a class="anchor" href="#table-of-contents"><span class="icon icon-link"></span></a>Table of Contents</h2>
<ul>
<li><a href="/blog/deploy-your-next-js-website-to-github-pages#prerequisites">Prerequisites</a></li>
<li><a href="/blog/deploy-your-next-js-website-to-github-pages#project-setup">Project setup</a></li>
<li><a href="/blog/deploy-your-next-js-website-to-github-pages#continuous-integration">Continuous integration</a></li>
<li><a href="/blog/deploy-your-next-js-website-to-github-pages#fixing-links">Fixing links</a></li>
<li><a href="/blog/deploy-your-next-js-website-to-github-pages#the-public-folder">The public folder</a></li>
<li><a href="/blog/deploy-your-next-js-website-to-github-pages#environment-variables">Environment variables</a></li>
<li><a href="/blog/deploy-your-next-js-website-to-github-pages#image-optimization">Image Optimization</a></li>
<li><a href="/blog/deploy-your-next-js-website-to-github-pages#conclusion">Conclusion</a></li>
</ul>
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"><span class="icon icon-link"></span></a>Prerequisites</h2>
<ul>
<li>Have and LTS version of <a target="_blank" rel="noopener noreferrer" href="https://nodejs.org/en/">Node.js</a> installed on your computer</li>
</ul>
<p>This command should output a version number.</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">$ <span class="token function">node</span> --version
</span></code></pre>
<ul>
<li>Make sure you have <a target="_blank" rel="noopener noreferrer" href="https://www.npmjs.com/">npm</a> installed (which should be after installing node.js)</li>
</ul>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">$ <span class="token function">npm</span> --version
</span></code></pre>
<ul>
<li>Have a text editor ready on your computer, I am using <a target="_blank" rel="noopener noreferrer" href="https://code.visualstudio.com/">Visual Studio Code</a></li>
<li>Install <a target="_blank" rel="noopener noreferrer" href="https://git-scm.com/">git</a> on your computer and follow the setup instructions guide</li>
</ul>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">$ <span class="token function">git</span> --version
</span></code></pre>
<ul>
<li>Log in or create a <a target="_blank" rel="noopener noreferrer" href="https://github.com/">Github</a> account</li>
</ul>
<h2 id="project-setup"><a class="anchor" href="#project-setup"><span class="icon icon-link"></span></a>Project setup</h2>
<p>Create a Next.js website with TypeScript (typescript is optional).</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">$ npx create-next-app --typescript
</span></code></pre>
<p><code>cd</code> into your newly created Nextjs project and open with your editor.</p>
<p>In your <code>package.json</code> file, add the export script into the <code>scripts</code> section.</p>
<pre class="language-diff"><code class="language-diff code-highlight"><span class="code-line">&quot;scripts&quot;: {
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &quot;dev&quot;: &quot;next dev&quot;,
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">   &quot;build&quot;: &quot;next build&quot;,
</span></span></span><span class="code-line inserted"><span class="token unchanged"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   &quot;export&quot;: &quot;next export&quot;,
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &quot;start&quot;: &quot;next start&quot;,
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">   &quot;lint&quot;: &quot;next lint&quot;
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span></span></code></pre>
<p>In the <code>pages/index.tsx</code> or <code>pages/index.jsx</code> of your project, replace the <code>&lt;Image /&gt;</code> component to legacy <code>&lt;img&gt;</code> html tag and remove the import.</p>
<pre class="language-diff"><code class="language-diff code-highlight"><span class="code-line deleted"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> &lt;Image src=&quot;/vercel.svg&quot; alt=&quot;Vercel Logo&quot; width={72} height={16} /&gt;
</span></span></span><span class="code-line inserted"><span class="token deleted-sign deleted"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> &lt;img src=&quot;/vercel.svg&quot; alt=&quot;Vercel Logo&quot; width={72} height={16} /&gt;
</span></span></span></code></pre>
<pre class="language-diff"><code class="language-diff code-highlight"><span class="code-line deleted"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import Image from &quot;next/image&quot;;
</span></span></span></code></pre>
<p>In your <code>/public</code> folder, place a <code>.nojekyll</code> file to disable Github Pages from trying to create a <a target="_blank" rel="noopener noreferrer" href="https://github.blog/2009-12-29-bypassing-jekyll-on-github-pages/">Jekyll</a> website.</p>
<p>Now run the following commands.</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">$ <span class="token function">npm</span> run build
</span><span class="code-line">$ <span class="token function">npm</span> run <span class="token builtin class-name">export</span>
</span></code></pre>
<p>These commands should not output any errors. Note that for already big next projects, the <code>export</code> command outputs errors if you are:</p>
<ul>
<li>using <a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/api-reference/data-fetching/get-initial-props">getInitialProps</a> in your project</li>
<li>using <a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/api-reference/data-fetching/get-server-side-props">getServersideProps</a></li>
<li>returning a <code>fallback</code> to <code>true</code> in your <a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/basic-features/data-fetching/get-static-paths">getStaticPaths</a></li>
</ul>
<h2 id="continuous-integration"><a class="anchor" href="#continuous-integration"><span class="icon icon-link"></span></a>Continuous integration</h2>
<p>Now that you have no error output, Put a <code>deploy.yml</code> file in a <code>.github/workflows/</code> folder you will create in your root directory. Below is the content of the <code>deploy.yml</code> file. : (pay attention to indentation)</p>
<pre class="language-yml"><code class="language-yml code-highlight"><span class="code-line"><span class="token key atrule">name</span><span class="token punctuation">:</span> Node.js CI
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">on</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">push</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">branches</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">jobs</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">build</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
</span><span class="code-line">
</span><span class="code-line">    <span class="token key atrule">strategy</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">matrix</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">node-version</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>12.x<span class="token punctuation">,</span> 14.x<span class="token punctuation">,</span> 16.x<span class="token punctuation">]</span>
</span><span class="code-line">        <span class="token comment"># See supported Node.js release schedule at https://nodejs.org/en/about/releases/</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Use Node.js $<span class="token punctuation">{</span><span class="token punctuation">{</span> matrix.node<span class="token punctuation">-</span>version <span class="token punctuation">}</span><span class="token punctuation">}</span>
</span><span class="code-line">        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>node@v2
</span><span class="code-line">        <span class="token key atrule">with</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">node-version</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> matrix.node<span class="token punctuation">-</span>version <span class="token punctuation">}</span><span class="token punctuation">}</span>
</span><span class="code-line">          <span class="token key atrule">cache</span><span class="token punctuation">:</span> <span class="token string">&#x27;npm&#x27;</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm i
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run export
</span><span class="code-line">
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy ðŸš€
</span><span class="code-line">        <span class="token key atrule">uses</span><span class="token punctuation">:</span> JamesIves/github<span class="token punctuation">-</span>pages<span class="token punctuation">-</span>deploy<span class="token punctuation">-</span>action@v4.2.5
</span><span class="code-line">        <span class="token key atrule">with</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">GITHUB_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span>
</span><span class="code-line">          <span class="token key atrule">branch</span><span class="token punctuation">:</span> gh<span class="token punctuation">-</span>pages <span class="token comment"># The branch the action should deploy to.</span>
</span><span class="code-line">          <span class="token key atrule">folder</span><span class="token punctuation">:</span> out <span class="token comment"># The folder the action should deploy.</span>
</span></code></pre>
<p>Now create a github repository for your new Nextjs project. Commit your local changes and push them to your github repo.</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">$ <span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
</span><span class="code-line">$ <span class="token function">git</span> commit -m <span class="token string">&quot;Initialize repository and CI workflow&quot;</span>
</span><span class="code-line">$ <span class="token function">git</span> remote <span class="token function">add</span> origin <span class="token operator">&lt;</span>your-github-repo-url<span class="token operator">&gt;</span>
</span><span class="code-line">$ <span class="token function">git</span> push -u origin main
</span></code></pre>
<p>Have a look at the Actions tab in your Github repository to see the workflow running. What this action does is described in the <code>deploy.yml</code> file we just created and it will always fire up whenever you push to the <code>main</code> branch of your remote repository.</p>
<p>Wait until all the jobs have been checked off. Now you have one extra branch <code>gh-pages</code> created by the workflow to host your static files from the <code>out/</code> folder.
Go to <strong>settings</strong> &gt; <strong>pages</strong> and make sure you have your <code>gh-pages</code> branch selected for the github pages source.</p>
<p>If not, run your workflow again in the Actions tab. Now your site is deployed to Github pages and you can access it via <code>&lt;your-github-username&gt;.github.io/&lt;your-repo-name&gt;</code> and it looks ... horrible ðŸ¤£.</p>
<div data-rmiz-wrap="visible"><img src="/me/static/images/Nextjs/site-not-conf.png" alt="Site malconfigured" width="730" class="rounded-lg"/><button aria-label="Zoom image" data-rmiz-btn-open="true"></button></div>
<p>Where them CSSes at? What just happened is that Next.js looks for your static assets from the base url but our github pages website has a <code>repo-name</code> suffix attached to it so it can&#x27;t find neither the js nor the css files.</p>
<h2 id="fixing-links"><a class="anchor" href="#fixing-links"><span class="icon icon-link"></span></a>Fixing links</h2>
<p>From Nextjs version 9.5+, we can configure a custom <a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/api-reference/next.config.js/cdn-support-with-asset-prefix"><code>assetPrefix</code></a> and Next.js will automatically use your prefix in the scripts it loads.</p>
<p>To do so, create or go to your <code>next.config.js</code> file and add the following.</p>
<pre class="language-diff"><code class="language-diff code-highlight"><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const isProd = process.env.NODE_ENV === &#x27;production&#x27;
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span>
</span><span class="code-line">module.exports = {
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  reactStrictMode: true,
</span></span></span><span class="code-line inserted"><span class="token unchanged"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  basePath = isProd ? &#x27;/&lt;your-repo-name&gt;&#x27; : &#x27;&#x27;,
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  assetPrefix = isProd ? &#x27;/&lt;your-repo-name&gt;&#x27; : &#x27;&#x27;
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span>}
</span></code></pre>
<p>Note the <a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/api-reference/next.config.js/basepath"><code>basePath</code></a> value we added which Next.js also uses as prefix for links with <a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/docs/api-reference/next/link"><code>next/link</code></a> components we might add later to the website.</p>
<p>Push your changes again to the main branch repo after committing your changes. The workflow will then automatically rerun the deployment scripts and update your deployed website.</p>
<h2 id="the-public-folder"><a class="anchor" href="#the-public-folder"><span class="icon icon-link"></span></a>The public folder</h2>
<p>Now we believe we are done with links, but will find out later that assets originating from the <code>public/</code> folder will still not be visible in Next.js.</p>
<blockquote>
<p>Next.js will automatically use your prefix in the scripts it loads, but this has no effect whatsoever on the public folder.</p>
</blockquote>
<p>Therefore, the prefix for these assets has to be handled manually. Like for images :</p>
<pre class="language-jsx"><code class="language-jsx code-highlight"><span class="code-line"><span class="token keyword">const</span> assetPrefix <span class="token operator">=</span> <span class="token string">&#x27;/&lt;your-repo-name&gt;&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
</span></span><span class="code-line"><span class="token tag">  <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>assetPrefix<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>src<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">  <span class="token attr-name">alt</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>alt<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">  <span class="token attr-name">width</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>width<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">  <span class="token attr-name">height</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>height<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">  <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>className<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag"><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>img</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
</span></code></pre>
<p>Fonts :</p>
<pre class="language-css"><code class="language-css code-highlight"><span class="code-line"><span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">&#x27;IBM Plex Sans&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token property">font-style</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token property">font-weight</span><span class="token punctuation">:</span> <span class="token number">100</span> <span class="token number">900</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token property">font-display</span><span class="token punctuation">:</span> optional<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token property">src</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>/&lt;your-repo-name&gt;/ibm-plex-sans-var.woff2<span class="token punctuation">)</span></span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&#x27;woff2&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<p>And everything laying in the <code>public/</code> folder. It now becomes a big problem because when our repository name changes, we have to update everything referencing the value while hoping not to miss any.</p>
<h2 id="environment-variables"><a class="anchor" href="#environment-variables"><span class="icon icon-link"></span></a>Environment variables</h2>
<p>First rule of coding is to never hard code changing values. Keeping the first rule in mind is the second. We should consider using global variables or even environment variables.</p>
<p>We can benefit from those environment variables by just making a little modification to our <code>deploy.yml</code> file :</p>
<pre class="language-diff"><code class="language-diff code-highlight"><span class="code-line">...
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> - name: Use Node.js ${{ matrix.node-version }}
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">   uses: actions/setup-node@v2
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">   with:
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">     node-version: ${{ matrix.node-version }}
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">     cache: &#x27;npm&#x27;
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line"> - run: npm i
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line"> - run: npm run build
</span></span></span><span class="code-line inserted"><span class="token unchanged"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   env:
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">     NEXT_PUBLIC_BASE_PATH: /&lt;your-repo-name&gt;
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> - run: npm run export
</span></span></span><span class="code-line inserted"><span class="token unchanged"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   env:
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">     NEXT_PUBLIC_BASE_PATH: /&lt;your-repo-name&gt;
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span>...
</span></code></pre>
<p>and reference the value by its name in the <code>next.config.js</code> file :</p>
<pre class="language-diff"><code class="language-diff code-highlight"><span class="code-line deleted"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> const isProd = process.env.NODE_ENV === &#x27;production&#x27;
</span></span></span><span class="code-line"><span class="token deleted-sign deleted"><span class="token line"></span></span>
</span><span class="code-line">module.exports = {
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  reactStrictMode: true,
</span></span></span><span class="code-line deleted"><span class="token unchanged"><span class="token line"></span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  basePath = isProd ? &#x27;/&lt;your-repo-name&gt;&#x27; : &#x27;&#x27;,
</span></span></span><span class="code-line deleted"><span class="token deleted-sign deleted"><span class="token line"></span><span class="token prefix deleted">-</span><span class="token line">  assetPrefix = isProd ? &#x27;/&lt;your-repo-name&gt;&#x27; : &#x27;&#x27;
</span></span></span><span class="code-line inserted"><span class="token deleted-sign deleted"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  assetPrefix = process.env.NEXT_PUBLIC_BASE_PATH || &#x27;&#x27;,
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  assetPrefix = process.env.NEXT_PUBLIC_BASE_PATH || &#x27;&#x27;
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span>}
</span></code></pre>
<p>As well as in all files having an <code>&lt;img&gt;</code> tag, but it is recommended to create a custom <code>&lt;Image /&gt;</code> component in a <code>components/</code> folder in the root directory and use this component all over the project.</p>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token imports"><span class="token maybe-class-name">React</span></span> <span class="token keyword">from</span> <span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> <span class="token function-variable function">Image</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> src<span class="token punctuation">,</span> alt<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> className <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NEXT_PUBLIC_BASE_PATH</span> <span class="token operator">||</span> <span class="token string">&#x27;&#x27;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>src<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">alt</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>alt<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">width</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>width<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">height</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>height<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>className<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">    <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>img</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token maybe-class-name">Image</span><span class="token punctuation">;</span>
</span></code></pre>
<h2 id="image-optimization"><a class="anchor" href="#image-optimization"><span class="icon icon-link"></span></a>Image optimization</h2>
<p>Now that all of our images display correctly across the entire website and environment variables saved us from sleepless nights of production debugging, it is time to tackle image optimization because Nextjs automatically optimizes them at runtime with Vercel so we should mimic the same functionality.</p>
<p>Run the following command to install <a target="_blank" rel="noopener noreferrer" href="https://github.com/cyrilwanner/next-optimized-images"><code>next-optimized-image</code></a> package.</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">$ <span class="token function">npm</span> <span class="token function">install</span> next-optimized-images
</span></code></pre>
<p>Enable the plugin in your <code>next.config.js</code> file:</p>
<pre class="language-diff"><code class="language-diff code-highlight"><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const withPlugins = require(&#x27;next-compose-plugins&#x27;);
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line"> const optimizedImages = require(&#x27;next-optimized-images&#x27;);
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span>
</span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> module.exports = withPlugins([
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  [optimizedImages, {
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">    /* config for next-optimized-images */
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  }],
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  reactStrictMode: true,
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">  assetPrefix = process.env.NEXT_PUBLIC_BASE_PATH || &#x27;&#x27;,
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">  assetPrefix = process.env.NEXT_PUBLIC_BASE_PATH || &#x27;&#x27;
</span></span></span><span class="code-line inserted"><span class="token unchanged"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">]);
</span></span></span></code></pre>
<p>You can see the <a target="_blank" rel="noopener noreferrer" href="https://github.com/cyrilwanner/next-optimized-images#configuration">configuration Section</a> of <code>next-optimized-images</code> for all available config options.</p>
<h2 id="conclusion"><a class="anchor" href="#conclusion"><span class="icon icon-link"></span></a>Conclusion</h2>
<p>Deploying your Next app to GitHub Pages is not the most intuitive way of doing it, and by far. Vercel would offer the <em>one click</em> deploy option every normal people would use but I don&#x27;t write articles for normal people :). Nonetheless, taking this challenge taught us some really important aspect of software develoment, that is, mastering CI workflows a bit and factoring our code to prevent bugs (but not switching to dark mode :)). I hope this article helped his readers a lot and please do not hesitate to create an issue or make pull requests on this article, I appreciate any contributions.</p></div><div class="mt-8"></div><div class="text-sm text-gray-700 dark:text-gray-300"><a href="https://github.com/rbaks/me/edit/main/data/blog/deploy-your-next-js-website-to-github-pages.mdx" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a></div></article><footer class="flex flex-col justify-center items-start max-w-2xl mx-auto w-full mb-8"><hr class="w-full border-1 border-gray-200 dark:border-gray-800 mb-8"/><div class="flex flex-row-reverse items-center sm:flex-row mb-8 space-x-0 sm:space-x-2 w-full"><svg class="h-4 w-4 ml-auto mt-[-2px]" viewBox="0 0 168 168"><path fill="#1ED760" d="M83.996.277C37.747.277.253 37.77.253 84.019c0 46.251 37.494 83.741 83.743 83.741 46.254 0 83.744-37.49 83.744-83.741 0-46.246-37.49-83.738-83.745-83.738l.001-.004zm38.404 120.78a5.217 5.217 0 01-7.18 1.73c-19.662-12.01-44.414-14.73-73.564-8.07a5.222 5.222 0 01-6.249-3.93 5.213 5.213 0 013.926-6.25c31.9-7.291 59.263-4.15 81.337 9.34 2.46 1.51 3.24 4.72 1.73 7.18zm10.25-22.805c-1.89 3.075-5.91 4.045-8.98 2.155-22.51-13.839-56.823-17.846-83.448-9.764-3.453 1.043-7.1-.903-8.148-4.35a6.538 6.538 0 014.354-8.143c30.413-9.228 68.222-4.758 94.072 11.127 3.07 1.89 4.04 5.91 2.15 8.976v-.001zm.88-23.744c-26.99-16.031-71.52-17.505-97.289-9.684-4.138 1.255-8.514-1.081-9.768-5.219a7.835 7.835 0 015.221-9.771c29.581-8.98 78.756-7.245 109.83 11.202a7.823 7.823 0 012.74 10.733c-2.2 3.722-7.02 4.949-10.73 2.739z"></path></svg><div class="inline-flex flex-col sm:flex-row w-full max-w-full truncate"><p class="capsize text-gray-800 dark:text-gray-200 font-medium">Not Playing</p><span class="capsize mx-2 text-gray-500 dark:text-gray-300 hidden sm:block"> â€“ </span><p class="capsize text-gray-500 dark:text-gray-300 max-w-max truncate">Spotify</p></div></div><div class="w-full max-w-2xl grid grid-cols-1 gap-4 pb-16 sm:grid-cols-3"><div class="flex flex-col space-y-4"><a class="text-gray-500 hover:text-gray-600 transition" href="/me">Home</a><a class="text-gray-500 hover:text-gray-600 transition" href="/me/about">About</a><a class="text-gray-500 hover:text-gray-600 transition" href="/me/newsletter">Newsletter</a></div><div class="flex flex-col space-y-4"></div><div class="flex flex-col space-y-4"><a class="text-gray-500 hover:text-gray-600 transition" target="_blank" rel="noopener noreferrer" href="https://github.com/rbaks">GitHub</a><a class="text-gray-500 hover:text-gray-600 transition" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/arabakoson/?locale=en_US">LinkedIn</a><a class="text-gray-500 hover:text-gray-600 transition" target="_blank" rel="noopener noreferrer" href="https://web.facebook.com/andrianina.rabakoson.79">Facebook</a></div></div></footer></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Deploy your Next.js website to Github Pages","publishedAt":"2022-03-15","summary":"Setup your Next.js website to deploy on Github pages with Github Actions","image":"/static/images/banner2.png","featured":true,"draft":false,"body":{"raw":"\nThe [2021 Stackoverflow developer survey](https://insights.stackoverflow.com/survey/2021#most-popular-technologies-webframe-prof) revealed the massive adoption of Meta's [React.js](https://reactjs.org/) open source library within the frontend industry.\n\n\u003cImage\n  alt=\"Stackoverflow developer survey\"\n  src={`/static/images/Nextjs/React-developer-survey.png`}\n  width={730}\n/\u003e\n\nIn the meantime, developers started gathering maximum best practices on core [web vitals](https://web.dev/vitals/) to boost the performance of their websites and get better [search engine optimization](https://en.wikipedia.org/wiki/Search_engine_optimization).\n\nHowever, this is a lot of code to maintain that you are tempted to create a superset of React.js yourself to continue implementing those best practices across all of your websites.\n\nThankfully, some group of engineers from [Vercel](https://vercel.com/) made and maintains all of this for us. Meet **[Next.js](https://nextjs.org/)**, **the React Framework for production**.\nNext.js is a static site generator that seats on top of React.js and offers performance out of the box. It has features such as :\n\n- [File-system routing](https://nextjs.org/docs/routing/introduction) as opposed to the React router\n- [Image Optimization](https://nextjs.org/docs/basic-features/image-optimization) out of the box\n- [Static-site generation](https://nextjs.org/docs/basic-features/data-fetching/get-static-props) and [server-side rendering](https://nextjs.org/docs/basic-features/data-fetching/get-server-side-props)\n- [Code splitting and Bundling](https://nextjs.org/docs)\n- [API Routes](https://nextjs.org/docs/api-routes/introduction)\n\nAnd much more with [Zero configuration](https://nextjs.org/docs/getting-started). Next.js was then the way to go for people who cares a lot about performance.\n\nCurrently, the Vercel platform offers the simplest method of deploying your Next.js app to the internet, but it is not without its shortcomings.\n\n\u003cProsCard\n  title=\"Pros of Vercel deployment\"\n  pros={[\n    'Designed for Nextjs and all of its features',\n    'Deploy in seconds',\n    'Serve your content at the edge',\n    'Serverless functions'\n  ]}\n/\u003e\n\n\u003cConsCard\n  title=\"Cons of Vercel deployment\"\n  cons={[\n    'Vendor lock-in (Flexibility issues)',\n    'SSL certificate problems with some domain names',\n    'Might not be free forever'\n  ]}\n/\u003e\n\nThanks to the Vercel team, they thought about us and added the [`export`](https://nextjs.org/docs/advanced-features/static-html-export) feature to the Next.js Framework.\n\n\u003e next export allows you to export your Next.js application to static HTML, which can be run standalone without the need of a Node.js server.\n\nIn other words, it allows us to deploy our Next.js website to [Github pages](https://pages.github.com/) that has no certificate problems, is always free, is fully flexible, has no data owned by third parties and is developer friendly. Thank you Vercel ðŸ¥³ðŸ¥³ðŸ¥³.\n\nNevertheless, there is no such thing as perfection. It is recommended to only use next export if you don't need any of the [unsupported features](https://nextjs.org/docs/advanced-features/static-html-export#unsupported-features) requiring a server. That is the purpose of this article where we will go through all the steps of configuring your Next.js website to mimic the normal Vercel deployment on GitHub Pages, which reflects how I made this entire portfolio website.\n\n## Table of Contents\n\n- [Prerequisites](/blog/deploy-your-next-js-website-to-github-pages#prerequisites)\n- [Project setup](/blog/deploy-your-next-js-website-to-github-pages#project-setup)\n- [Continuous integration](/blog/deploy-your-next-js-website-to-github-pages#continuous-integration)\n- [Fixing links](/blog/deploy-your-next-js-website-to-github-pages#fixing-links)\n- [The public folder](/blog/deploy-your-next-js-website-to-github-pages#the-public-folder)\n- [Environment variables](/blog/deploy-your-next-js-website-to-github-pages#environment-variables)\n- [Image Optimization](/blog/deploy-your-next-js-website-to-github-pages#image-optimization)\n- [Conclusion](/blog/deploy-your-next-js-website-to-github-pages#conclusion)\n\n## Prerequisites\n\n- Have and LTS version of [Node.js](https://nodejs.org/en/) installed on your computer\n\nThis command should output a version number.\n\n```bash\n$ node --version\n```\n\n- Make sure you have [npm](https://www.npmjs.com/) installed (which should be after installing node.js)\n\n```bash\n$ npm --version\n```\n\n- Have a text editor ready on your computer, I am using [Visual Studio Code](https://code.visualstudio.com/)\n- Install [git](https://git-scm.com/) on your computer and follow the setup instructions guide\n\n```bash\n$ git --version\n```\n\n- Log in or create a [Github](https://github.com/) account\n\n## Project setup\n\nCreate a Next.js website with TypeScript (typescript is optional).\n\n```bash\n$ npx create-next-app --typescript\n```\n\n`cd` into your newly created Nextjs project and open with your editor.\n\nIn your `package.json` file, add the export script into the `scripts` section.\n\n```diff\n\"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n+   \"export\": \"next export\",\n    \"start\": \"next start\",\n    \"lint\": \"next lint\"\n  },\n```\n\nIn the `pages/index.tsx` or `pages/index.jsx` of your project, replace the `\u003cImage /\u003e` component to legacy `\u003cimg\u003e` html tag and remove the import.\n\n```diff\n- \u003cImage src=\"/vercel.svg\" alt=\"Vercel Logo\" width={72} height={16} /\u003e\n+ \u003cimg src=\"/vercel.svg\" alt=\"Vercel Logo\" width={72} height={16} /\u003e\n```\n\n```diff\n- import Image from \"next/image\";\n```\n\nIn your `/public` folder, place a `.nojekyll` file to disable Github Pages from trying to create a [Jekyll](https://github.blog/2009-12-29-bypassing-jekyll-on-github-pages/) website.\n\nNow run the following commands.\n\n```bash\n$ npm run build\n$ npm run export\n```\n\nThese commands should not output any errors. Note that for already big next projects, the `export` command outputs errors if you are:\n\n- using [getInitialProps](https://nextjs.org/docs/api-reference/data-fetching/get-initial-props) in your project\n- using [getServersideProps](https://nextjs.org/docs/api-reference/data-fetching/get-server-side-props)\n- returning a `fallback` to `true` in your [getStaticPaths](https://nextjs.org/docs/basic-features/data-fetching/get-static-paths)\n\n## Continuous integration\n\nNow that you have no error output, Put a `deploy.yml` file in a `.github/workflows/` folder you will create in your root directory. Below is the content of the `deploy.yml` file. : (pay attention to indentation)\n\n```yml\nname: Node.js CI\n\non:\n  push:\n    branches: [main]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n\n    strategy:\n      matrix:\n        node-version: [12.x, 14.x, 16.x]\n        # See supported Node.js release schedule at https://nodejs.org/en/about/releases/\n\n    steps:\n      - uses: actions/checkout@v2\n      - name: Use Node.js ${{ matrix.node-version }}\n        uses: actions/setup-node@v2\n        with:\n          node-version: ${{ matrix.node-version }}\n          cache: 'npm'\n      - run: npm i\n      - run: npm run build\n      - run: npm run export\n\n      - name: Deploy ðŸš€\n        uses: JamesIves/github-pages-deploy-action@v4.2.5\n        with:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n          branch: gh-pages # The branch the action should deploy to.\n          folder: out # The folder the action should deploy.\n```\n\nNow create a github repository for your new Nextjs project. Commit your local changes and push them to your github repo.\n\n```bash\n$ git add .\n$ git commit -m \"Initialize repository and CI workflow\"\n$ git remote add origin \u003cyour-github-repo-url\u003e\n$ git push -u origin main\n```\n\nHave a look at the Actions tab in your Github repository to see the workflow running. What this action does is described in the `deploy.yml` file we just created and it will always fire up whenever you push to the `main` branch of your remote repository.\n\nWait until all the jobs have been checked off. Now you have one extra branch `gh-pages` created by the workflow to host your static files from the `out/` folder.\nGo to **settings** \u003e **pages** and make sure you have your `gh-pages` branch selected for the github pages source.\n\nIf not, run your workflow again in the Actions tab. Now your site is deployed to Github pages and you can access it via `\u003cyour-github-username\u003e.github.io/\u003cyour-repo-name\u003e` and it looks ... horrible ðŸ¤£.\n\n\u003cImage\n  alt=\"Site malconfigured\"\n  src={`/static/images/Nextjs/site-not-conf.png`}\n  width={730}\n/\u003e\n\nWhere them CSSes at? What just happened is that Next.js looks for your static assets from the base url but our github pages website has a `repo-name` suffix attached to it so it can't find neither the js nor the css files.\n\n## Fixing links\n\nFrom Nextjs version 9.5+, we can configure a custom [`assetPrefix`](https://nextjs.org/docs/api-reference/next.config.js/cdn-support-with-asset-prefix) and Next.js will automatically use your prefix in the scripts it loads.\n\nTo do so, create or go to your `next.config.js` file and add the following.\n\n```diff\n+ const isProd = process.env.NODE_ENV === 'production'\n\nmodule.exports = {\n   reactStrictMode: true,\n+  basePath = isProd ? '/\u003cyour-repo-name\u003e' : '',\n+  assetPrefix = isProd ? '/\u003cyour-repo-name\u003e' : ''\n}\n```\n\nNote the [`basePath`](https://nextjs.org/docs/api-reference/next.config.js/basepath) value we added which Next.js also uses as prefix for links with [`next/link`](https://nextjs.org/docs/api-reference/next/link) components we might add later to the website.\n\nPush your changes again to the main branch repo after committing your changes. The workflow will then automatically rerun the deployment scripts and update your deployed website.\n\n## The public folder\n\nNow we believe we are done with links, but will find out later that assets originating from the `public/` folder will still not be visible in Next.js.\n\n\u003e Next.js will automatically use your prefix in the scripts it loads, but this has no effect whatsoever on the public folder.\n\nTherefore, the prefix for these assets has to be handled manually. Like for images :\n\n```jsx\nconst assetPrefix = '/\u003cyour-repo-name\u003e';\n\n\u003cimg\n  src={`${assetPrefix}${src}`}\n  alt={alt}\n  width={width}\n  height={height}\n  className={className}\n\u003e\u003c/img\u003e;\n```\n\nFonts :\n\n```css\n@font-face {\n  font-family: 'IBM Plex Sans';\n  font-style: normal;\n  font-weight: 100 900;\n  font-display: optional;\n  src: url(/\u003cyour-repo-name\u003e/ibm-plex-sans-var.woff2) format('woff2');\n}\n```\n\nAnd everything laying in the `public/` folder. It now becomes a big problem because when our repository name changes, we have to update everything referencing the value while hoping not to miss any.\n\n## Environment variables\n\nFirst rule of coding is to never hard code changing values. Keeping the first rule in mind is the second. We should consider using global variables or even environment variables.\n\nWe can benefit from those environment variables by just making a little modification to our `deploy.yml` file :\n\n```diff\n...\n  - name: Use Node.js ${{ matrix.node-version }}\n    uses: actions/setup-node@v2\n    with:\n      node-version: ${{ matrix.node-version }}\n      cache: 'npm'\n  - run: npm i\n  - run: npm run build\n+   env:\n+     NEXT_PUBLIC_BASE_PATH: /\u003cyour-repo-name\u003e\n  - run: npm run export\n+   env:\n+     NEXT_PUBLIC_BASE_PATH: /\u003cyour-repo-name\u003e\n...\n```\n\nand reference the value by its name in the `next.config.js` file :\n\n```diff\n- const isProd = process.env.NODE_ENV === 'production'\n\nmodule.exports = {\n   reactStrictMode: true,\n-  basePath = isProd ? '/\u003cyour-repo-name\u003e' : '',\n-  assetPrefix = isProd ? '/\u003cyour-repo-name\u003e' : ''\n+  assetPrefix = process.env.NEXT_PUBLIC_BASE_PATH || '',\n+  assetPrefix = process.env.NEXT_PUBLIC_BASE_PATH || ''\n}\n```\n\nAs well as in all files having an `\u003cimg\u003e` tag, but it is recommended to create a custom `\u003cImage /\u003e` component in a `components/` folder in the root directory and use this component all over the project.\n\n```tsx\nimport React from 'react';\n\nconst Image = ({ src, alt, width, height, className }) =\u003e {\n  return (\n    \u003cimg\n      src={`${process.env.NEXT_PUBLIC_BASE_PATH || ''}${src}`}\n      alt={alt}\n      width={width}\n      height={height}\n      className={className}\n    \u003e\u003c/img\u003e\n  );\n};\n\nexport default Image;\n```\n\n## Image optimization\n\nNow that all of our images display correctly across the entire website and environment variables saved us from sleepless nights of production debugging, it is time to tackle image optimization because Nextjs automatically optimizes them at runtime with Vercel so we should mimic the same functionality.\n\nRun the following command to install [`next-optimized-image`](https://github.com/cyrilwanner/next-optimized-images) package.\n\n```bash\n$ npm install next-optimized-images\n```\n\nEnable the plugin in your `next.config.js` file:\n\n```diff\n+ const withPlugins = require('next-compose-plugins');\n+ const optimizedImages = require('next-optimized-images');\n\n+ module.exports = withPlugins([\n+  [optimizedImages, {\n+    /* config for next-optimized-images */\n+  }],\n   reactStrictMode: true,\n   assetPrefix = process.env.NEXT_PUBLIC_BASE_PATH || '',\n   assetPrefix = process.env.NEXT_PUBLIC_BASE_PATH || ''\n+]);\n```\n\nYou can see the [configuration Section](https://github.com/cyrilwanner/next-optimized-images#configuration) of `next-optimized-images` for all available config options.\n\n## Conclusion\n\nDeploying your Next app to GitHub Pages is not the most intuitive way of doing it, and by far. Vercel would offer the _one click_ deploy option every normal people would use but I don't write articles for normal people :). Nonetheless, taking this challenge taught us some really important aspect of software develoment, that is, mastering CI workflows a bit and factoring our code to prevent bugs (but not switching to dark mode :)). I hope this article helped his readers a lot and please do not hesitate to create an issue or make pull requests on this article, I appreciate any contributions.\n","code":"var Component=(()=\u003e{var m=Object.create;var l=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var f=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),y=(a,s)=\u003e{for(var c in s)l(a,c,{get:s[c],enumerable:!0})},d=(a,s,c,n)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let i of N(s))!g.call(a,i)\u0026\u0026i!==c\u0026\u0026l(a,i,{get:()=\u003es[i],enumerable:!(n=u(s,i))||n.enumerable});return a};var b=(a,s,c)=\u003e(c=a!=null?m(k(a)):{},d(s||!a||!a.__esModule?l(c,\"default\",{value:a,enumerable:!0}):c,a)),x=a=\u003ed(l({},\"__esModule\",{value:!0}),a);var h=f((T,p)=\u003e{p.exports=_jsx_runtime});var P={};y(P,{default:()=\u003ej,frontmatter:()=\u003ew});var e=b(h()),w={title:\"Deploy your Next.js website to Github Pages\",publishedAt:\"2022-03-15\",summary:\"Setup your Next.js website to deploy on Github pages with Github Actions\",image:\"/static/images/banner2.png\",featured:!0,draft:!1};function v(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({p:\"p\",a:\"a\",strong:\"strong\",ul:\"ul\",li:\"li\",code:\"code\",blockquote:\"blockquote\",h2:\"h2\",span:\"span\",pre:\"pre\",em:\"em\"},a.components),{Image:i,ProsCard:o,ConsCard:r}=n;return r||t(\"ConsCard\",!0),i||t(\"Image\",!0),o||t(\"ProsCard\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.p,{children:[\"The \",(0,e.jsx)(n.a,{href:\"https://insights.stackoverflow.com/survey/2021#most-popular-technologies-webframe-prof\",children:\"2021 Stackoverflow developer survey\"}),\" revealed the massive adoption of Meta's \",(0,e.jsx)(n.a,{href:\"https://reactjs.org/\",children:\"React.js\"}),\" open source library within the frontend industry.\"]}),`\n`,(0,e.jsx)(i,{alt:\"Stackoverflow developer survey\",src:\"/static/images/Nextjs/React-developer-survey.png\",width:730}),`\n`,(0,e.jsxs)(n.p,{children:[\"In the meantime, developers started gathering maximum best practices on core \",(0,e.jsx)(n.a,{href:\"https://web.dev/vitals/\",children:\"web vitals\"}),\" to boost the performance of their websites and get better \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Search_engine_optimization\",children:\"search engine optimization\"}),\".\"]}),`\n`,(0,e.jsx)(n.p,{children:\"However, this is a lot of code to maintain that you are tempted to create a superset of React.js yourself to continue implementing those best practices across all of your websites.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Thankfully, some group of engineers from \",(0,e.jsx)(n.a,{href:\"https://vercel.com/\",children:\"Vercel\"}),\" made and maintains all of this for us. Meet \",(0,e.jsx)(n.strong,{children:(0,e.jsx)(n.a,{href:\"https://nextjs.org/\",children:\"Next.js\"})}),\", \",(0,e.jsx)(n.strong,{children:\"the React Framework for production\"}),`.\nNext.js is a static site generator that seats on top of React.js and offers performance out of the box. It has features such as :`]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/routing/introduction\",children:\"File-system routing\"}),\" as opposed to the React router\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/basic-features/image-optimization\",children:\"Image Optimization\"}),\" out of the box\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/basic-features/data-fetching/get-static-props\",children:\"Static-site generation\"}),\" and \",(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/basic-features/data-fetching/get-server-side-props\",children:\"server-side rendering\"})]}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs\",children:\"Code splitting and Bundling\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/api-routes/introduction\",children:\"API Routes\"})}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"And much more with \",(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/getting-started\",children:\"Zero configuration\"}),\". Next.js was then the way to go for people who cares a lot about performance.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Currently, the Vercel platform offers the simplest method of deploying your Next.js app to the internet, but it is not without its shortcomings.\"}),`\n`,(0,e.jsx)(o,{title:\"Pros of Vercel deployment\",pros:[\"Designed for Nextjs and all of its features\",\"Deploy in seconds\",\"Serve your content at the edge\",\"Serverless functions\"]}),`\n`,(0,e.jsx)(r,{title:\"Cons of Vercel deployment\",cons:[\"Vendor lock-in (Flexibility issues)\",\"SSL certificate problems with some domain names\",\"Might not be free forever\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Thanks to the Vercel team, they thought about us and added the \",(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/advanced-features/static-html-export\",children:(0,e.jsx)(n.code,{children:\"export\"})}),\" feature to the Next.js Framework.\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"next export allows you to export your Next.js application to static HTML, which can be run standalone without the need of a Node.js server.\"}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"In other words, it allows us to deploy our Next.js website to \",(0,e.jsx)(n.a,{href:\"https://pages.github.com/\",children:\"Github pages\"}),\" that has no certificate problems, is always free, is fully flexible, has no data owned by third parties and is developer friendly. Thank you Vercel \\u{1F973}\\u{1F973}\\u{1F973}.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Nevertheless, there is no such thing as perfection. It is recommended to only use next export if you don't need any of the \",(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/advanced-features/static-html-export#unsupported-features\",children:\"unsupported features\"}),\" requiring a server. That is the purpose of this article where we will go through all the steps of configuring your Next.js website to mimic the normal Vercel deployment on GitHub Pages, which reflects how I made this entire portfolio website.\"]}),`\n`,(0,e.jsxs)(n.h2,{id:\"table-of-contents\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#table-of-contents\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Table of Contents\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"/blog/deploy-your-next-js-website-to-github-pages#prerequisites\",children:\"Prerequisites\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"/blog/deploy-your-next-js-website-to-github-pages#project-setup\",children:\"Project setup\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"/blog/deploy-your-next-js-website-to-github-pages#continuous-integration\",children:\"Continuous integration\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"/blog/deploy-your-next-js-website-to-github-pages#fixing-links\",children:\"Fixing links\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"/blog/deploy-your-next-js-website-to-github-pages#the-public-folder\",children:\"The public folder\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"/blog/deploy-your-next-js-website-to-github-pages#environment-variables\",children:\"Environment variables\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"/blog/deploy-your-next-js-website-to-github-pages#image-optimization\",children:\"Image Optimization\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"/blog/deploy-your-next-js-website-to-github-pages#conclusion\",children:\"Conclusion\"})}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"prerequisites\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#prerequisites\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Prerequisites\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"Have and LTS version of \",(0,e.jsx)(n.a,{href:\"https://nodejs.org/en/\",children:\"Node.js\"}),\" installed on your computer\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"This command should output a version number.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"node\"}),` --version\n`]})})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"Make sure you have \",(0,e.jsx)(n.a,{href:\"https://www.npmjs.com/\",children:\"npm\"}),\" installed (which should be after installing node.js)\"]}),`\n`]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"npm\"}),` --version\n`]})})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"Have a text editor ready on your computer, I am using \",(0,e.jsx)(n.a,{href:\"https://code.visualstudio.com/\",children:\"Visual Studio Code\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[\"Install \",(0,e.jsx)(n.a,{href:\"https://git-scm.com/\",children:\"git\"}),\" on your computer and follow the setup instructions guide\"]}),`\n`]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"git\"}),` --version\n`]})})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"Log in or create a \",(0,e.jsx)(n.a,{href:\"https://github.com/\",children:\"Github\"}),\" account\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"project-setup\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#project-setup\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Project setup\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Create a Next.js website with TypeScript (typescript is optional).\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`$ npx create-next-app --typescript\n`})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"cd\"}),\" into your newly created Nextjs project and open with your editor.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"In your \",(0,e.jsx)(n.code,{children:\"package.json\"}),\" file, add the export script into the \",(0,e.jsx)(n.code,{children:\"scripts\"}),\" section.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-diff\",children:(0,e.jsxs)(n.code,{className:\"language-diff code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`\"scripts\": {\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:`   \"dev\": \"next dev\",\n`})]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:`   \"build\": \"next build\",\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line inserted\",children:[(0,e.jsx)(n.span,{className:\"token unchanged\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`   \"export\": \"next export\",\n`})]})]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token inserted-sign inserted\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:`   \"start\": \"next start\",\n`})]})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:`   \"lint\": \"next lint\"\n`})]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:` },\n`})]})})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"In the \",(0,e.jsx)(n.code,{children:\"pages/index.tsx\"}),\" or \",(0,e.jsx)(n.code,{children:\"pages/index.jsx\"}),\" of your project, replace the \",(0,e.jsx)(n.code,{children:\"\u003cImage /\u003e\"}),\" component to legacy \",(0,e.jsx)(n.code,{children:\"\u003cimg\u003e\"}),\" html tag and remove the import.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-diff\",children:(0,e.jsxs)(n.code,{className:\"language-diff code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line deleted\",children:(0,e.jsxs)(n.span,{className:\"token deleted-sign deleted\",children:[(0,e.jsx)(n.span,{className:\"token prefix deleted\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token line\",children:` \u003cImage src=\"/vercel.svg\" alt=\"Vercel Logo\" width={72} height={16} /\u003e\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line inserted\",children:[(0,e.jsx)(n.span,{className:\"token deleted-sign deleted\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:` \u003cimg src=\"/vercel.svg\" alt=\"Vercel Logo\" width={72} height={16} /\u003e\n`})]})]})]})}),`\n`,(0,e.jsx)(n.pre,{className:\"language-diff\",children:(0,e.jsx)(n.code,{className:\"language-diff code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line deleted\",children:(0,e.jsxs)(n.span,{className:\"token deleted-sign deleted\",children:[(0,e.jsx)(n.span,{className:\"token prefix deleted\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token line\",children:` import Image from \"next/image\";\n`})]})})})}),`\n`,(0,e.jsxs)(n.p,{children:[\"In your \",(0,e.jsx)(n.code,{children:\"/public\"}),\" folder, place a \",(0,e.jsx)(n.code,{children:\".nojekyll\"}),\" file to disable Github Pages from trying to create a \",(0,e.jsx)(n.a,{href:\"https://github.blog/2009-12-29-bypassing-jekyll-on-github-pages/\",children:\"Jekyll\"}),\" website.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Now run the following commands.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"npm\"}),` run build\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"npm\"}),\" run \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"export\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"These commands should not output any errors. Note that for already big next projects, the \",(0,e.jsx)(n.code,{children:\"export\"}),\" command outputs errors if you are:\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"using \",(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/api-reference/data-fetching/get-initial-props\",children:\"getInitialProps\"}),\" in your project\"]}),`\n`,(0,e.jsxs)(n.li,{children:[\"using \",(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/api-reference/data-fetching/get-server-side-props\",children:\"getServersideProps\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[\"returning a \",(0,e.jsx)(n.code,{children:\"fallback\"}),\" to \",(0,e.jsx)(n.code,{children:\"true\"}),\" in your \",(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/basic-features/data-fetching/get-static-paths\",children:\"getStaticPaths\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"continuous-integration\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#continuous-integration\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Continuous integration\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Now that you have no error output, Put a \",(0,e.jsx)(n.code,{children:\"deploy.yml\"}),\" file in a \",(0,e.jsx)(n.code,{children:\".github/workflows/\"}),\" folder you will create in your root directory. Below is the content of the \",(0,e.jsx)(n.code,{children:\"deploy.yml\"}),\" file. : (pay attention to indentation)\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-yml\",children:(0,e.jsxs)(n.code,{className:\"language-yml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Node.js CI\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"on\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"push\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"branches\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"main\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"jobs\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"build\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"runs-on\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" ubuntu\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`latest\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"strategy\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"matrix\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"node-version\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"12.x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" 14.x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" 16.x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# See supported Node.js release schedule at https://nodejs.org/en/about/releases/\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"steps\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"uses\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` actions/checkout@v2\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" Use Node.js $\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" matrix.node\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"version \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"uses\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" actions/setup\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`node@v2\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"with\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"node-version\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" matrix.node\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"version \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"cache\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'npm'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"run\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` npm i\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"run\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` npm run build\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"run\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` npm run export\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Deploy \\u{1F680}\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"uses\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" JamesIves/github\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"pages\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"deploy\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`action@v4.2.5\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"with\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"GITHUB_TOKEN\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" secrets.GITHUB_TOKEN \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"branch\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" gh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"pages \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# The branch the action should deploy to.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"folder\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" out \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# The folder the action should deploy.\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Now create a github repository for your new Nextjs project. Commit your local changes and push them to your github repo.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"git\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"add\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\".\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"git\"}),\" commit -m \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Initialize repository and CI workflow\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"git\"}),\" remote \",(0,e.jsx)(n.span,{className:\"token function\",children:\"add\"}),\" origin \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),\"your-github-repo-url\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"git\"}),` push -u origin main\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Have a look at the Actions tab in your Github repository to see the workflow running. What this action does is described in the \",(0,e.jsx)(n.code,{children:\"deploy.yml\"}),\" file we just created and it will always fire up whenever you push to the \",(0,e.jsx)(n.code,{children:\"main\"}),\" branch of your remote repository.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Wait until all the jobs have been checked off. Now you have one extra branch \",(0,e.jsx)(n.code,{children:\"gh-pages\"}),\" created by the workflow to host your static files from the \",(0,e.jsx)(n.code,{children:\"out/\"}),` folder.\nGo to `,(0,e.jsx)(n.strong,{children:\"settings\"}),\" \u003e \",(0,e.jsx)(n.strong,{children:\"pages\"}),\" and make sure you have your \",(0,e.jsx)(n.code,{children:\"gh-pages\"}),\" branch selected for the github pages source.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"If not, run your workflow again in the Actions tab. Now your site is deployed to Github pages and you can access it via \",(0,e.jsx)(n.code,{children:\"\u003cyour-github-username\u003e.github.io/\u003cyour-repo-name\u003e\"}),\" and it looks ... horrible \\u{1F923}.\"]}),`\n`,(0,e.jsx)(i,{alt:\"Site malconfigured\",src:\"/static/images/Nextjs/site-not-conf.png\",width:730}),`\n`,(0,e.jsxs)(n.p,{children:[\"Where them CSSes at? What just happened is that Next.js looks for your static assets from the base url but our github pages website has a \",(0,e.jsx)(n.code,{children:\"repo-name\"}),\" suffix attached to it so it can't find neither the js nor the css files.\"]}),`\n`,(0,e.jsxs)(n.h2,{id:\"fixing-links\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#fixing-links\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Fixing links\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"From Nextjs version 9.5+, we can configure a custom \",(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/api-reference/next.config.js/cdn-support-with-asset-prefix\",children:(0,e.jsx)(n.code,{children:\"assetPrefix\"})}),\" and Next.js will automatically use your prefix in the scripts it loads.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"To do so, create or go to your \",(0,e.jsx)(n.code,{children:\"next.config.js\"}),\" file and add the following.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-diff\",children:(0,e.jsxs)(n.code,{className:\"language-diff code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line inserted\",children:(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:` const isProd = process.env.NODE_ENV === 'production'\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token inserted-sign inserted\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`module.exports = {\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  reactStrictMode: true,\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line inserted\",children:[(0,e.jsx)(n.span,{className:\"token unchanged\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  basePath = isProd ? '/\u003cyour-repo-name\u003e' : '',\n`})]})]}),(0,e.jsx)(n.span,{className:\"code-line inserted\",children:(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  assetPrefix = isProd ? '/\u003cyour-repo-name\u003e' : ''\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token inserted-sign inserted\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),`}\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Note the \",(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/api-reference/next.config.js/basepath\",children:(0,e.jsx)(n.code,{children:\"basePath\"})}),\" value we added which Next.js also uses as prefix for links with \",(0,e.jsx)(n.a,{href:\"https://nextjs.org/docs/api-reference/next/link\",children:(0,e.jsx)(n.code,{children:\"next/link\"})}),\" components we might add later to the website.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Push your changes again to the main branch repo after committing your changes. The workflow will then automatically rerun the deployment scripts and update your deployed website.\"}),`\n`,(0,e.jsxs)(n.h2,{id:\"the-public-folder\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#the-public-folder\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"The public folder\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Now we believe we are done with links, but will find out later that assets originating from the \",(0,e.jsx)(n.code,{children:\"public/\"}),\" folder will still not be visible in Next.js.\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Next.js will automatically use your prefix in the scripts it loads, but this has no effect whatsoever on the public folder.\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"Therefore, the prefix for these assets has to be handled manually. Like for images :\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-jsx\",children:(0,e.jsxs)(n.code,{className:\"language-jsx code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" assetPrefix \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'/\u003cyour-repo-name\u003e'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),\"img\"]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"src\"}),(0,e.jsxs)(n.span,{className:\"token script language-javascript\",children:[(0,e.jsx)(n.span,{className:\"token script-punctuation punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token template-punctuation string\",children:\"`\"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"${\"}),\"assetPrefix\",(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"}\"})]}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"${\"}),\"src\",(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token template-punctuation string\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"alt\"}),(0,e.jsxs)(n.span,{className:\"token script language-javascript\",children:[(0,e.jsx)(n.span,{className:\"token script-punctuation punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"alt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"width\"}),(0,e.jsxs)(n.span,{className:\"token script language-javascript\",children:[(0,e.jsx)(n.span,{className:\"token script-punctuation punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"width\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"height\"}),(0,e.jsxs)(n.span,{className:\"token script language-javascript\",children:[(0,e.jsx)(n.span,{className:\"token script-punctuation punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"height\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"className\"}),(0,e.jsxs)(n.span,{className:\"token script language-javascript\",children:[(0,e.jsx)(n.span,{className:\"token script-punctuation punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"className\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token tag\",children:(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})}),(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"img\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Fonts :\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-css\",children:(0,e.jsxs)(n.code,{className:\"language-css code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule\",children:(0,e.jsx)(n.span,{className:\"token rule\",children:\"@font-face\"})}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:\"font-family\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'IBM Plex Sans'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:\"font-style\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" normal\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:\"font-weight\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"100\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"900\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:\"font-display\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" optional\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:\"src\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsxs)(n.span,{className:\"token url\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"url\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"/\u003cyour-repo-name\u003e/ibm-plex-sans-var.woff2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"})]}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"format\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'woff2'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"And everything laying in the \",(0,e.jsx)(n.code,{children:\"public/\"}),\" folder. It now becomes a big problem because when our repository name changes, we have to update everything referencing the value while hoping not to miss any.\"]}),`\n`,(0,e.jsxs)(n.h2,{id:\"environment-variables\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#environment-variables\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Environment variables\"]}),`\n`,(0,e.jsx)(n.p,{children:\"First rule of coding is to never hard code changing values. Keeping the first rule in mind is the second. We should consider using global variables or even environment variables.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"We can benefit from those environment variables by just making a little modification to our \",(0,e.jsx)(n.code,{children:\"deploy.yml\"}),\" file :\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-diff\",children:(0,e.jsxs)(n.code,{className:\"language-diff code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`...\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:\" - name: Use Node.js ${{ matrix.node-version }}\\n\"})]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:`   uses: actions/setup-node@v2\n`})]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:`   with:\n`})]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:\"     node-version: ${{ matrix.node-version }}\\n\"})]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:`     cache: 'npm'\n`})]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:` - run: npm i\n`})]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:` - run: npm run build\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line inserted\",children:[(0,e.jsx)(n.span,{className:\"token unchanged\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`   env:\n`})]})]}),(0,e.jsx)(n.span,{className:\"code-line inserted\",children:(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`     NEXT_PUBLIC_BASE_PATH: /\u003cyour-repo-name\u003e\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token inserted-sign inserted\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:` - run: npm run export\n`})]})]}),(0,e.jsxs)(n.span,{className:\"code-line inserted\",children:[(0,e.jsx)(n.span,{className:\"token unchanged\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`   env:\n`})]})]}),(0,e.jsx)(n.span,{className:\"code-line inserted\",children:(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`     NEXT_PUBLIC_BASE_PATH: /\u003cyour-repo-name\u003e\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token inserted-sign inserted\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),`...\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"and reference the value by its name in the \",(0,e.jsx)(n.code,{children:\"next.config.js\"}),\" file :\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-diff\",children:(0,e.jsxs)(n.code,{className:\"language-diff code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line deleted\",children:(0,e.jsxs)(n.span,{className:\"token deleted-sign deleted\",children:[(0,e.jsx)(n.span,{className:\"token prefix deleted\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token line\",children:` const isProd = process.env.NODE_ENV === 'production'\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token deleted-sign deleted\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`module.exports = {\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  reactStrictMode: true,\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line deleted\",children:[(0,e.jsx)(n.span,{className:\"token unchanged\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),(0,e.jsxs)(n.span,{className:\"token deleted-sign deleted\",children:[(0,e.jsx)(n.span,{className:\"token prefix deleted\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  basePath = isProd ? '/\u003cyour-repo-name\u003e' : '',\n`})]})]}),(0,e.jsx)(n.span,{className:\"code-line deleted\",children:(0,e.jsxs)(n.span,{className:\"token deleted-sign deleted\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix deleted\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  assetPrefix = isProd ? '/\u003cyour-repo-name\u003e' : ''\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line inserted\",children:[(0,e.jsx)(n.span,{className:\"token deleted-sign deleted\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  assetPrefix = process.env.NEXT_PUBLIC_BASE_PATH || '',\n`})]})]}),(0,e.jsx)(n.span,{className:\"code-line inserted\",children:(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  assetPrefix = process.env.NEXT_PUBLIC_BASE_PATH || ''\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token inserted-sign inserted\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),`}\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"As well as in all files having an \",(0,e.jsx)(n.code,{children:\"\u003cimg\u003e\"}),\" tag, but it is recommended to create a custom \",(0,e.jsx)(n.code,{children:\"\u003cImage /\u003e\"}),\" component in a \",(0,e.jsx)(n.code,{children:\"components/\"}),\" folder in the root directory and use this component all over the project.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-tsx\",children:(0,e.jsxs)(n.code,{className:\"language-tsx code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,e.jsx)(n.span,{className:\"token imports\",children:(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"React\"})}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'react'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,e.jsx)(n.span,{className:\"token function-variable function\",children:\"Image\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" src\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" alt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" width\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" height\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" className \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token arrow operator\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),\"img\"]}),`\n`]})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"src\"}),(0,e.jsxs)(n.span,{className:\"token script language-javascript\",children:[(0,e.jsx)(n.span,{className:\"token script-punctuation punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token template-punctuation string\",children:\"`\"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"${\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"env\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"NEXT_PUBLIC_BASE_PATH\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"||\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"''\"}),(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"}\"})]}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"${\"}),\"src\",(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token template-punctuation string\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"alt\"}),(0,e.jsxs)(n.span,{className:\"token script language-javascript\",children:[(0,e.jsx)(n.span,{className:\"token script-punctuation punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"alt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"width\"}),(0,e.jsxs)(n.span,{className:\"token script language-javascript\",children:[(0,e.jsx)(n.span,{className:\"token script-punctuation punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"width\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"height\"}),(0,e.jsxs)(n.span,{className:\"token script language-javascript\",children:[(0,e.jsx)(n.span,{className:\"token script-punctuation punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"height\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"className\"}),(0,e.jsxs)(n.span,{className:\"token script language-javascript\",children:[(0,e.jsx)(n.span,{className:\"token script-punctuation punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"className\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"img\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"default\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"Image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.h2,{id:\"image-optimization\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#image-optimization\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Image optimization\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Now that all of our images display correctly across the entire website and environment variables saved us from sleepless nights of production debugging, it is time to tackle image optimization because Nextjs automatically optimizes them at runtime with Vercel so we should mimic the same functionality.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Run the following command to install \",(0,e.jsx)(n.a,{href:\"https://github.com/cyrilwanner/next-optimized-images\",children:(0,e.jsx)(n.code,{children:\"next-optimized-image\"})}),\" package.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"npm\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),` next-optimized-images\n`]})})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Enable the plugin in your \",(0,e.jsx)(n.code,{children:\"next.config.js\"}),\" file:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-diff\",children:(0,e.jsxs)(n.code,{className:\"language-diff code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line inserted\",children:(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:` const withPlugins = require('next-compose-plugins');\n`})]})}),(0,e.jsx)(n.span,{className:\"code-line inserted\",children:(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:` const optimizedImages = require('next-optimized-images');\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token inserted-sign inserted\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line inserted\",children:(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:` module.exports = withPlugins([\n`})]})}),(0,e.jsx)(n.span,{className:\"code-line inserted\",children:(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  [optimizedImages, {\n`})]})}),(0,e.jsx)(n.span,{className:\"code-line inserted\",children:(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`    /* config for next-optimized-images */\n`})]})}),(0,e.jsx)(n.span,{className:\"code-line inserted\",children:(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  }],\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token inserted-sign inserted\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  reactStrictMode: true,\n`})]})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  assetPrefix = process.env.NEXT_PUBLIC_BASE_PATH || '',\n`})]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token unchanged\",children:[(0,e.jsx)(n.span,{className:\"token line\"}),(0,e.jsx)(n.span,{className:\"token prefix unchanged\",children:\" \"}),(0,e.jsx)(n.span,{className:\"token line\",children:`  assetPrefix = process.env.NEXT_PUBLIC_BASE_PATH || ''\n`})]})}),(0,e.jsxs)(n.span,{className:\"code-line inserted\",children:[(0,e.jsx)(n.span,{className:\"token unchanged\",children:(0,e.jsx)(n.span,{className:\"token line\"})}),(0,e.jsxs)(n.span,{className:\"token inserted-sign inserted\",children:[(0,e.jsx)(n.span,{className:\"token prefix inserted\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token line\",children:`]);\n`})]})]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"You can see the \",(0,e.jsx)(n.a,{href:\"https://github.com/cyrilwanner/next-optimized-images#configuration\",children:\"configuration Section\"}),\" of \",(0,e.jsx)(n.code,{children:\"next-optimized-images\"}),\" for all available config options.\"]}),`\n`,(0,e.jsxs)(n.h2,{id:\"conclusion\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#conclusion\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Deploying your Next app to GitHub Pages is not the most intuitive way of doing it, and by far. Vercel would offer the \",(0,e.jsx)(n.em,{children:\"one click\"}),\" deploy option every normal people would use but I don't write articles for normal people :). Nonetheless, taking this challenge taught us some really important aspect of software develoment, that is, mastering CI workflows a bit and factoring our code to prevent bugs (but not switching to dark mode :)). I hope this article helped his readers a lot and please do not hesitate to create an issue or make pull requests on this article, I appreciate any contributions.\"]})]})}}var j=v;function t(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return x(P);})();\n;return Component;"},"_id":"blog/deploy-your-next-js-website-to-github-pages.mdx","_raw":{"sourceFilePath":"blog/deploy-your-next-js-website-to-github-pages.mdx","sourceFileName":"deploy-your-next-js-website-to-github-pages.mdx","sourceFileDir":"blog","contentType":"mdx","flattenedPath":"blog/deploy-your-next-js-website-to-github-pages"},"type":"Blog","readingTime":{"text":"9 min read","minutes":8.77,"time":526200,"words":1754},"wordCount":1756,"slug":"deploy-your-next-js-website-to-github-pages"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"deploy-your-next-js-website-to-github-pages"},"buildId":"qUJK-3Xpp2cRBJdT5XkrN","assetPrefix":"/me","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>